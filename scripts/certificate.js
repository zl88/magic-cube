var certName,certSolved,certMovesNumber,certMovesHeader,certDate,certTimeNumber,certTimeHeader,lineLeft,lineRight,coords,cubeletsUnused=new ERNO.Group,textBoxes=[],buttons=[],frames=[],tweenSpeed=600,allObjects=[],certificateCreated=!1;function doCertificate(){certificateCreated||(certificateCreated=!0,cube.mouseControlsEnabled=!1,cube.keyboardControlsEnabled=!1,document.getElementById("container").appendChild(cube.domElement),makeCertificate())}function animateCubeBack(e){var t=document.getElementById("bg"),o={camZ:cube.camera.position.z,fov:cube.camera.fov,x:cube.position.x,y:cube.position.y,z:cube.position.z,xRot:cube.rotation.x,yRot:cube.rotation.y,zRot:cube.rotation.z,bgOpacity:1};new TWEEN.Tween(o).to({camZ:2800,fov:49,x:0,y:0,z:0,xRot:90..degreesToRadians(),yRot:(0).degreesToRadians(),zRot:135..degreesToRadians(),bgOpacity:0},1e3).onUpdate((function(){cube.camera.position.z=o.camZ,cube.camera.fov=o.fov,cube.position.set(o.x,o.y,o.z),cube.rotation.set(o.xRot,o.yRot,o.zRot),t.style.opacity=o.bgOpacity})).easing(TWEEN.Easing.Quartic.InOut).onComplete((function(){e()})).start(cube.time)}function makeCertificate(){cube.hideInvisibleFaces=!1,cube.showIntroverts(),resetPositions(),setupTextBoxes(),setupObjects(),setupCore(),isIe&&prepareFaces(),importFramesFromJson(),preparePlayBack(),animateCubeBack(playFrames)}function resetPositions(){cube.cubelets.forEach((function(e){e.css3DObject.position.copy(e.position),e.position.set(0,0,0)}))}function setupObjects(){allObjects.push.apply(allObjects,cube.cubelets),allObjects.push.apply(allObjects,textBoxes)}function zeroPad(e,t){for(;(""+e).length<t;)e="0"+e;return e}var dataStore={msgs:{"Certificate Moves":"Moves","Certificate Time":"Time","Certificate Title":"Cube Solved","Directions 1":"Swipe outside the cube to rotate it.","Directions 2":"Swipe inside to twist the cube.","Directions 3":"Keyboard commands work too.","Directions UI 1":"Next","Directions UI 2":"Done","Error Version 1":"Oops! This doodle uses some experimental web technology that may not work on your device.","Error Version 2":"To play, please use a supported hardware configuration and the latest version of one of these browsers:","Mobile Certificate Cube":"Cube","Mobile Certificate Solved":"Solved","Share Message":"The Rubikâ€™s Cube is 40! #CubeDoodle","Share Message Completed":"#CubeDoodle solved!!","Sign In Button":"Sign in","Sign In Message":"Sign in to add your name"},origin:"",session:"",dir:"",hl:"en",user:"",shortlink:"google.com/doodles"},parsedData={},matches=window.location.hash.match(/[#&]data=([^&]*)/);if(matches&&matches.length>1)try{parsedData=JSON.parse(decodeURIComponent(matches[1]))||{}}catch(e){}function mergeObject(e,t){for(var o in e)"object"==typeof e[o]?mergeObject(e[o],t[o]):t[o]=e[o]||t[o]}function setupTextBoxes(){if(isIe){var e=new THREE.Object3D,t=new THREE.CSS3DRenderer,o=new THREE.Object3D,a=new THREE.Object3D,r=document.getElementById("container");r.appendChild(t.domElement),t.domElement.style.position="absolute",t.domElement.style.top="0px",t.domElement.style.left="0px",o.matrix=cube.matrix,o.matrixWorld=cube.matrixWorld,o.matrixAutoUpdate=!1,a.matrix=cube.autoRotateObj3D.matrix,a.matrixWorld=cube.autoRotateObj3D.matrixWorld,a.matrixAutoUpdate=!1,o.name="cube",e.add(a),a.add(o),requestAnimationFrame((function o(){var a=r.clientWidth,i=r.clientHeight;!cube.domElement.parentNode||t.domElement.clientWidth===a&&t.domElement.clientHeight===i||t.setSize(a,i),t.render(e,cube.camera),requestAnimationFrame(o)}))}var i=isIe?{object3D:o}:cube;isMobile?(certName=new ResizeableTextBox(i,"certName",dataStore.msgs["Mobile Certificate Cube"]),certSolved=new ResizeableTextBox(i,"certSolved",dataStore.msgs["Mobile Certificate Solved"])):(certSolved=new ResizeableTextBox(i,"certSolved",dataStore.user),certName=new ResizeableTextBox(i,"certName",dataStore.msgs["Certificate Title"]));var s=cube.moveCounter;s=zeroPad(s,4),certMovesNumber=new TextBox(i,"certMovesNumber",s),certMovesHeader=new TextBox(i,"certMovesHeader",dataStore.msgs["Certificate Moves"]);var c=new Date,n=["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"][c.getMonth()],l=c.getFullYear()+"-"+zeroPad(c.getMonth(),2)+"-"+zeroPad(c.getDate(),2),m=dataStore.hl||en;"en"==m?l=n+" "+c.getDate()+", "+c.getFullYear():c.toLocaleDateString&&(l=c.toLocaleDateString(m)),certDate=new TextBox(i,"certDate",l),(navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1)&&(certDate.domElement.style.marginTop="-210px");var u=(c.getTime()-startTime)/1e3,d=zeroPad(Math.floor(u%60),2),b=zeroPad(Math.floor(u/60),2);certTimeNumber=new TextBox(i,"certTimeNumber",b+":"+d),certTimeHeader=new TextBox(i,"certTimeHeader",dataStore.msgs["Certificate Time"]),certLarryName=new TextBox(i,"certLarryName","Lawrence Page"),certErnoName=new TextBox(i,"certErnoName","Erno Rubik"),googleLogo=new DivBox(i,"googleLogo"),larrySignature=new DivBox(i,"larrySignature"),ernoSignature=new DivBox(i,"ernoSignature"),lineLeft=new DivBox(i,"lineLeft"),lineRight=new DivBox(i,"lineRight"),(textBoxes=[certName,certSolved,certMovesNumber,certMovesHeader,certDate,certTimeNumber,certTimeHeader,certLarryName,certErnoName,googleLogo,larrySignature,ernoSignature,lineLeft,lineRight]).forEach((function(e){e.opacity=0,e.css3DObject.element.style.opacity=0}))}function setupCore(){(cube.cubelets[13].faces.forEach((function(e){var t=document.createElement("div");t.classList.add("logoFace"),e.element.appendChild(t)})),isIe)&&document.querySelectorAll(".faceDown .logoFace")[0].classList.add("ie")}function prepareFaces(){for(var e=document.querySelectorAll(".cube .face"),t=0;t<e.length;t++)e[t].style.webkitBackfaceVisibility="visible",e[t].style.mozBackfaceVisibility="visible",e[t].style.oBackfaceVisibility="visible",e[t].style.backfaceVisibility="visible"}function preparePlayBack(){allObjects.forEach((function(e){e.frames=[]})),frames.forEach((function(e,t){e.forEach((function(e,t){var o=allObjects[e.id],a={x:e.position.x,y:e.position.y,z:e.position.z,xr:e.rotation.x,yr:e.rotation.y,zr:e.rotation.z,xrcss:e.rotationCSS.x,yrcss:e.rotationCSS.y,zrcss:e.rotationCSS.z,opacity:e.opacity};o.frames.push(a)}))})),allObjects.forEach((function(e){e.tweens=[];for(var t=0;t<e.frames.length-1;t++){var o=new TWEEN.Tween(e.frames[t]).to({x:e.frames[t+1].x,y:e.frames[t+1].y,z:e.frames[t+1].z,xr:e.frames[t+1].xr,yr:e.frames[t+1].yr,zr:e.frames[t+1].zr,xrcss:e.frames[t+1].xrcss,yrcss:e.frames[t+1].yrcss,zrcss:e.frames[t+1].zrcss,opacity:e.frames[t+1].opacity},tweenSpeed).easing(TWEEN.Easing.Quartic.Out).onUpdate((function(){if(e.css3DObject.position.x=this.x,e.css3DObject.position.y=this.y,e.css3DObject.position.z=this.z,e.rotation.x=this.xr,e.rotation.y=this.yr,e.rotation.z=this.zr,e.css3DObject.rotation.x=this.xrcss,e.css3DObject.rotation.y=this.yrcss,e.css3DObject.rotation.z=this.zrcss,e.css3DObject.element)e.css3DObject.element.style.opacity=this.opacity;else for(var t=6;t-- >0;)e.faces[t].element.style.opacity=this.opacity;e.opacity=this.opacity}));e.tweens.push(o)}for(t=0;t<e.tweens.length-1;t++)e.tweens[t].chain(e.tweens[t+1])}))}function playFrames(){allObjects.forEach((function(e){e.tweens[0].start(cube.time)}))}function importFramesFromJson(){frames=isMobile?certDataMobile.frames:certData.frames}mergeObject(parsedData,dataStore);